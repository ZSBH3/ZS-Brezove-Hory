<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Informační tabule ZŠ Březové Hory</title>
  <style>
    * {box-sizing: border-box; margin: 0; padding: 0;}
    html, body {
      height: 100%;
      font-family: "Segoe UI", Roboto, Arial, sans-serif;
      background: linear-gradient(180deg, #0b152a 0%, #081020 100%);
      color: #f3f6fa;
      overflow: hidden;
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .board {
      display: grid;
      grid-template-columns: 1fr 1fr;
      grid-template-rows: auto 1fr auto;
      gap: 25px;
      width: 90%;
      height: 90%;
      max-width: 1600px;
      padding: 40px;
      border-radius: 25px;
      background: rgba(255, 255, 255, 0.05);
      box-shadow: 0 0 40px rgba(0,0,0,0.4);
      text-align: center;
    }

    h1 {
      grid-column: 1 / -1;
      font-size: 2.5rem;
      letter-spacing: 1px;
      margin-bottom: 10px;
      color: #ffd44c;
    }

    .card {
      background: rgba(255,255,255,0.08);
      border-radius: 16px;
      padding: 20px;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      font-size: 1.2rem;
      overflow-y: auto;
    }

    .time {
      font-size: 2rem;
      font-weight: bold;
      margin-bottom: 10px;
    }

    .weather {
      font-size: 1.3rem;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    #obed {
      text-align: left;
      font-size: 1rem;
      line-height: 1.6;
      overflow-y: auto;
      width: 100%;
      max-height: 400px;
    }

    footer {
      grid-column: 1 / -1;
      font-size: 0.9rem;
      opacity: 0.7;
    }
  </style>
</head>
<body>
  <div class="board">
    <h1>🧭 Informační tabule — ZŠ Březové Hory</h1>

    <div class="card">
      <div class="time" id="cas"></div>
      <div id="datum"></div>
      <div class="weather" id="pocasi">Načítám počasí...</div>
    </div>

    <div class="card">
      <h2>🍽️ Dnešní oběd</h2>
      <div id="obed">Načítám jídelníček...</div>
    </div>

    <div class="card">
      <h2>📅 Plán akcí</h2>
      <p>Zatím žádné akce nejsou naplánovány.</p>
    </div>

    <div class="card">
      <h2>📢 Aktuality ze školy</h2>
      <p>Zatím žádné aktuality.</p>
    </div>

    <footer>
      Stránka se aktualizuje každých 15 minut • © 2025 ZŠ Březové Hory
    </footer>
  </div>

  <script>
    // 🕒 Čas a datum
    function updateTime() {
      const now = new Date();
      const d = now.toLocaleDateString('cs-CZ', { weekday:'long', year:'numeric', month:'long', day:'numeric' });
      const t = now.toLocaleTimeString('cs-CZ');
      document.getElementById('cas').textContent = t;
      document.getElementById('datum').textContent = d;
    }
    setInterval(updateTime, 1000);
    updateTime();

    // 🌦️ Počasí (Open-Meteo)
    async function loadWeather() {
      try {
        const res = await fetch("https://api.open-meteo.com/v1/forecast?latitude=49.69&longitude=14.01&current_weather=true");
        const data = await res.json();
        const teplota = data.current_weather.temperature;
        const vitr = data.current_weather.windspeed;
        document.getElementById("pocasi").innerHTML = `🌡️ ${teplota} °C, 💨 vítr ${vitr} km/h`;
      } catch (e) {
        document.getElementById("pocasi").innerText = "Nelze načíst počasí.";
      }
    }
    loadWeather();

    // 🍽️ Jídelníček (proxy)
    async function loadObed() {
      try {
        const proxyUrl = "https://api.allorigins.win/get?url=" + encodeURIComponent("https://zsbrezovehory.cz/jidelni-listek/");
        const res = await fetch(proxyUrl);
        const data = await res.json();
        const obsah = data.contents.match(/<main[\\s\\S]*?<\\/main>/i);
        document.getElementById("obed").innerHTML = obsah ? obsah[0] : "Nelze načíst jídelníček.";
      } catch (e) {
        document.getElementById("obed").innerText = "Chyba při načítání jídelníčku.";
      }
    }
    loadObed();

    // 🔁 Auto-refresh po 15 minutách
    setTimeout(() => location.reload(), 15 * 60 * 1000);
  </script>
</body>
</html>

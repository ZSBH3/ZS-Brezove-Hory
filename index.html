<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Informaƒçn√≠ tabule ‚Äî Z≈† B≈ôezov√© Hory</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<style>
:root{
--bg1:#08272d;
--bg2:#0e3b46;
--accent:#ff8a3d;
--glass: rgba(255,255,255,0.04);
--card:#0b2530;
--muted:#9fb0bd;
--radius:18px;
--gap:18px;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#eaf2f5}
body{display:flex;align-items:center;justify-content:center;padding:18px}
.board{width:100%;height:100%;max-width:2000px;max-height:1200px;display:grid;grid-template-columns:1.35fr 0.95fr;grid-template-rows:1fr 1fr;gap:var(--gap);align-items:stretch;background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:22px;border-radius:26px;box-shadow:0 20px 60px rgba(1,8,12,0.6), inset 0 1px 0 rgba(255,255,255,0.02);overflow:hidden;}
.topbar{grid-column:1/-1;display:flex;justify-content:space-between;align-items:center;gap:16px;padding:8px 16px;}
.title{display:flex;align-items:center;gap:14px;}
.logo{width:72px;height:72px;border-radius:12px;background:linear-gradient(135deg,#00b3a6,#045a63);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:26px;color:white;box-shadow:0 6px 18px rgba(0,0,0,0.5);}
.school-name{font-size:28px;font-weight:700;letter-spacing:0.6px;color:#ffefdc;text-shadow:0 3px 20px rgba(0,0,0,0.4);}
.meta{color:var(--muted);font-size:13px;}
.card{background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius: var(--radius);padding:18px;box-shadow: 0 10px 40px rgba(1,8,12,0.5);border:1px solid rgba(255,255,255,0.04);display:flex;flex-direction:column;gap:10px;min-height:120px;}
.card-header{display:flex;align-items:center;gap:12px;}
.card-header .icon{font-size:28px;color:var(--accent);text-shadow:0 0 14px rgba(255,138,61,0.15)}
.card-header h3{margin:0;font-size:18px;color:#ffdcbc}
.left-top{grid-column:1/2;grid-row:1/2;display:grid;grid-template-columns:1fr 1fr;gap:var(--gap)}
.left-bottom{grid-column:1/2;grid-row:2/3;display:grid;grid-template-columns:1fr 1fr;gap:var(--gap)}
.right-all{grid-column:2/3;grid-row:1/3;display:flex;flex-direction:column;gap:var(--gap)}
#obed{font-size:1rem;line-height:1.6;color:#eaf2f5;overflow:auto;padding-right:6px}
#obed h4{margin:0 0 8px 0;color:#ffd9b8}
#obed .meal{padding:8px 10px;border-radius:10px;margin-bottom:8px;background:linear-gradient(90deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02)}
.clock-box{display:flex;flex-direction:column;align-items:flex-start;gap:8px}
#clock-time{font-size:48px;font-weight:700;color:#fff; letter-spacing:1px; text-shadow:0 6px 18px rgba(0,0,0,0.45)}
#clock-date{color:var(--muted);font-size:16px}
.weather-compact{display:flex;gap:12px;align-items:center}
.weather-compact .w-icon{font-size:34px}
.weather-compact .w-main{font-size:18px;font-weight:600}
.news{display:flex;gap:12px;align-items:flex-start}
.news .thumb{width:140px;height:100px;border-radius:10px;background:#072a2d;background-size:cover;background-position:center;flex-shrink:0}
.news .txt{flex:1;text-align:left;font-size:14px;color:#e6eef4}
.departures{display:flex;flex-direction:column;gap:6px;font-family:'Roboto Condensed',sans-serif;max-height:220px;overflow-y:auto;}
.dep-row{display:flex;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01);font-size:14px}
.dep-time{font-weight:700;color:#ffd9b8}
.ticker{grid-column:1/-1;height:38px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));display:flex;align-items:center;overflow:hidden;padding:6px 12px;border:1px solid rgba(255,255,255,0.03);}
.ticker .marquee{white-space:nowrap;display:inline-block;transform:translate3d(0,0,0);animation:marq 22s linear infinite}
@keyframes marq{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}
.live-clock-badge{position:fixed;left:28px;bottom:28px;background:var(--accent);color:#081018;padding:10px 14px;border-radius:10px;font-weight:700;box-shadow:0 8px 30px rgba(0,0,0,0.6);z-index:40}
@media (max-width:1200px){
.board{grid-template-columns: 1fr;grid-template-rows:auto 1fr 1fr;align-items:start}
.left-top,.left-bottom{grid-column:1}
.right-all{grid-column:1}
.live-clock-badge{left:14px;bottom:14px;font-size:14px}
}
</style>
</head>
<body>
<div class="board" id="board">
<div class="topbar">
<div class="title">
<div class="logo">≈†</div>
<div>
<div class="school-name">Z≈† B≈ôezov√© Hory</div>
<div class="meta" id="meta-status">Aktualizov√°no: ‚Äî</div>
</div>
</div>
<div class="meta">Nap√°jen√≠: online ‚Ä¢ Re≈æim: ve≈ôejn√° tabule</div>
</div>

<div class="left-top">
<div class="card">
<div class="card-header">
<div class="icon"><i class="fa-regular fa-clock"></i></div>
<div><h3>ƒåas & Datum</h3><div class="meta">P≈ôesnost: syst√©mov√°</div></div>
</div>
<div class="clock-box">
<div id="clock-time">--:--:--</div>
<div id="clock-date">‚Äî</div>
<div id="small-weather" class="weather-compact"><div class="w-icon">‚õÖ</div><div class="w-main">Naƒç√≠t√°m poƒças√≠...</div></div>
</div>
</div>

<div class="card">
<div class="card-header">
<div class="icon"><i class="fa-solid fa-bus"></i></div>
<div><h3>Odjezdy PID</h3><div class="meta">Autobusy ‚Äî Mari√°nsk√°, n√°m., domov senior≈Ø</div></div>
</div>
<div class="departures" id="departures">Naƒç√≠t√°m odjezdy...</div>
</div>
</div>

<div class="left-bottom">
<div class="card" style="min-height:260px">
<div class="card-header">
<div class="icon"><i class="fa-solid fa-utensils"></i></div>
<div><h3>Dne≈°n√≠ obƒõd</h3><div class="meta">Zdroj: zsbrezovehory.cz</div></div>
</div>
<div id="obed"><em>Naƒç√≠t√°m j√≠deln√≠ƒçek...</em></div>
</div>

<div class="card">
<div class="card-header">
<div class="icon"><i class="fa-regular fa-calendar-days"></i></div>
<div><h3>Pl√°n akc√≠</h3><div class="meta">Nejbli≈æ≈°√≠ ud√°losti</div></div>
</div>
<div>
<p style="text-align:left;font-size:15px"><strong>03.11.</strong> Exkurze do Planet√°ria ‚Ä¢ <strong>11.11.</strong> Den otev≈ôen√Ωch dve≈ô√≠ ‚Ä¢ <strong>20.12.</strong> V√°noƒçn√≠ koncert</p>
</div>
</div>
</div>

<div class="right-all">
<div class="card" style="flex:1 1 auto; display:flex; flex-direction:column;">
<div class="card-header">
<div class="icon"><i class="fa-solid fa-newspaper"></i></div>
<div><h3>Aktuality</h3><div class="meta">Novinky ze ≈°koly</div></div>
</div>
<div style="display:flex;gap:14px;margin-top:8px;align-items:flex-start">
<div class="news" style="flex:1">
<div class="thumb" id="news-thumb" style="background-image:url('');"></div>
<div class="txt" id="news-text">
<h4>St≈ôedo≈°kolsk√Ω atletick√Ω poh√°r ve znamen√≠ gymnazist≈Ø</h4>
<p>≈†koln√≠ dru≈æstvo dos√°hlo skvƒõl√Ωch v√Ωsledk≈Ø. Podrobnosti najdete na webu ≈°koly.</p>
</div>
</div>
</div>
<div style="margin-top:auto; margin-top:18px;">
<h4 style="color:#ffdcbc;margin-bottom:8px">Kr√°tk√© zpr√°vy</h4>
<ul style="text-align:left;color:#dfeaf2;line-height:1.6">
<li>Nov√© lavice v 7.A a 7.B.</li>
<li>Od 1. 11. zaƒç√≠n√° krou≈æek robotiky.</li>
<li>P≈ôihl√°≈°ky na ly≈æa≈ôsk√Ω v√Ωcvik do 30.11.</li>
</ul>
</div>
</div>

<div class="card" style="height:170px;display:flex;flex-direction:column;justify-content:space-between">
<div class="card-header">
<div class="icon"><i class="fa-solid fa-cloud-sun"></i></div>
<div><h3>Detail poƒças√≠</h3><div class="meta">Open-Meteo</div></div>
</div>
<div style="display:flex;justify-content:space-between;align-items:center">
<div>
<div style="font-size:22px;font-weight:700" id="weather-main">‚Äî</div>
<div style="color:var(--muted)" id="weather-sub">‚Äî</div>
</div>
<div style="text-align:right;color:var(--muted)">
<div>Rychlost vƒõtru</div>
<div id="wind">‚Äî km/h</div>
</div>
</div>
</div>
</div>

<div class="ticker" id="ticker">
<div class="marquee" id="marq">Ve ƒçtvrtek 30. ≈ô√≠jna se budou od 9:40 rozd√°vat tradiƒçn√≠ anglick√© certifik√°ty ve velk√© tƒõlocviƒçnƒõ.</div>
</div>
<div class="live-clock-badge" id="top-right-time">--:--</div>
</div>

<script>
const REFRESH_MIN = 15;

// --- ƒåAS ---
function updateClock(){
  const d=new Date();
  document.getElementById('clock-time').textContent=d.toLocaleTimeString('cs-CZ',{hour:'2-digit',minute:'2-digit',second:'2-digit'});
  document.getElementById('clock-date').textContent=d.toLocaleDateString('cs-CZ',{weekday:'long', year:'numeric', month:'long', day:'numeric'});
  document.getElementById('top-right-time').textContent=d.toLocaleTimeString('cs-CZ',{hour:'2-digit',minute:'2-digit'});
}
setInterval(updateClock,1000);
updateClock();

// --- POƒåAS√ç ---
async function fetchWeather(){
  try{
    const res=await fetch("https://api.open-meteo.com/v1/forecast?latitude=49.69&longitude=14.01&current_weather=true");
    const data=await res.json();
    const cur=data.current_weather;
    const code=cur.weathercode;
    const map={0:'Jasno',1:'Polojasno',2:'Oblaƒçno',3:'Zata≈æeno',45:'Mlha',48:'Mrznouc√≠ mlha',51:'Slab√© mrholen√≠',61:'D√©≈°≈•',71:'Sn√≠h',95:'Bou≈ôka'};
    const text=map[code]||'Poƒças√≠';
    document.getElementById('weather-main').textContent=`${cur.temperature} ¬∞C ‚Äî ${text}`;
    document.getElementById('weather-sub').textContent=`V√≠tr: ${cur.windspeed} km/h ‚Ä¢ Smƒõr: ${cur.winddirection}¬∞`;
    document.getElementById('wind').textContent=cur.windspeed+' km/h';
    document.querySelector('#small-weather .w-icon').textContent=(code===0? '‚òÄÔ∏è' : code<4? '‚õÖ':'‚òÅÔ∏è');
    document.querySelector('#small-weather .w-main').textContent=`${cur.temperature} ¬∞C`;
  }catch(err){console.warn(err);}
}

// --- J√çDELN√çƒåEK ---
async function fetchLunch(){
  try{
    const proxy="https://api.allorigins.win/raw?url=";
    const url="https://zsbrezovehory.cz/jidelni-listek/";
    const r=await fetch(proxy+encodeURIComponent(url));
    const html=await r.text();
    const parser=new DOMParser();
    const doc=parser.parseFromString(html,'text/html');
    let sel=doc.querySelector('main, article, .entry-content, .post-content, .elementor-widget-container');
    let content=sel?sel.innerHTML:'<em>Nelze naƒç√≠st</em>';
    content=content.replace(/<script[\s\S]*?<\/script>/gi,'').replace(/<img[^>]*>/gi,'');
    document.getElementById('obed').innerHTML=content;
  }catch(err){console.warn(err);document.getElementById('obed').innerHTML='<em>Chyba p≈ôi naƒç√≠t√°n√≠ j√≠deln√≠ƒçku</em>';}
}

// --- PID API p≈ôes proxy (funguje offline i z file://) ---
const PID_API_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NDA2NSwiaWF0IjoxNzYxMjg1NTE1LCJleHAiOjExNzYxMjg1NTE1LCJpc3MiOiJnb2xlbWlvIiwianRpIjoiYzNmYWY5MGMtMGEyMi00OWE1LWI1MDktM2NiM2YwN2NiOGU0In0.ugD7g2PQ_aLZX3Hhke3rnbxFWcmn_d_5_4BXcRH9qpw';
const PID_BASE = 'https://api.golemio.cz/pid/input-gateway/v1';
const PROXY = 'https://api.allorigins.win/raw?url=';

async function fetchDepartures(){
  const stops = [
    { id:'52838', name:'P≈ô√≠bram, B≈ôezov√© Hory, Mari√°nsk√°' },
    { id:'9739/1', name:'P≈ô√≠bram, B≈ôezov√© Hory, n√°mƒõst√≠ (smƒõr Mari√°nsk√°)' },
    { id:'1409175511863_MAI00278', name:'P≈ô√≠bram, B≈ôezov√© Hory, domov senior≈Ø' }
  ];
  const depDiv = document.getElementById('departures');
  depDiv.innerHTML = '';
  for(const s of stops){
    const url = `${PID_BASE}/departures?stopAreaId=${encodeURIComponent(s.id)}&maxNo=8`;
    const fullUrl = `${PROXY}${encodeURIComponent(url)}`;
    try{
      const res = await fetch(fullUrl, { headers:{ 'Authorization': `Bearer ${PID_API_KEY}` } });
      const data = await res.json();
      depDiv.innerHTML += `<div>üü† ${s.name}</div>`;
      if(data.departures && data.departures.length){
        data.departures.forEach(d=>{
          const line = d.route?.short_name || d.trip?.headsign || 'Linka';
          const time = d.departure_timestamp?.scheduled ? new Date(d.departure_timestamp.scheduled).toLocaleTimeString('cs-CZ',{hour:'2-digit',minute:'2-digit'}) : '?';
          depDiv.innerHTML += `<div class="dep-row"><div>${line} ‚Üí ${d.trip?.headsign||''}</div><div class="dep-time">${time}</div></div>`;
        });
      }else{
        depDiv.innerHTML += `<div class="dep-row">≈Ω√°dn√© spoje.</div>`;
      }
      depDiv.innerHTML += `<hr style="opacity:0.1">`;
    }catch(err){
      depDiv.innerHTML += `<div>Chyba: ${err.message}</div><hr style="opacity:0.1">`;
    }
  }
}

// --- Aktualizace v≈°ech ƒç√°st√≠ ---
async function refreshAll(){
  document.getElementById('meta-status').textContent='Aktualizov√°no: '+new Date().toLocaleTimeString('cs-CZ',{hour:'2-digit',minute:'2-digit'});
  fetchWeather();fetchLunch();fetchDepartures();
}
refreshAll();
setInterval(refreshAll, REFRESH_MIN*60000);
</script>
</body>
</html>

<!DOCTYPE html>
<html lang="cs">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Informaƒçn√≠ tabule ‚Äî Z≈† B≈ôezov√© Hory</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700&family=Roboto+Condensed:wght@400;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<style>
:root{
--bg1:#08272d;
--bg2:#0e3b46;
--accent:#ff8a3d;
--glass: rgba(255,255,255,0.04);
--card:#0b2530;
--muted:#9fb0bd;
--radius:18px;
--gap:18px;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(135deg,var(--bg1),var(--bg2));color:#eaf2f5}
body{display:flex;align-items:center;justify-content:center;padding:18px}
.board{width:100%;height:100%;max-width:2000px;max-height:1200px;display:grid;grid-template-columns:1.35fr 0.95fr;grid-template-rows:1fr 1fr;gap:var(--gap);align-items:stretch;background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:22px;border-radius:26px;box-shadow:0 20px 60px rgba(1,8,12,0.6), inset 0 1px 0 rgba(255,255,255,0.02);overflow:hidden;}
.topbar{grid-column:1/-1;display:flex;justify-content:space-between;align-items:center;gap:16px;padding:8px 16px;}
.title{display:flex;align-items:center;gap:14px;}
.logo{width:72px;height:72px;border-radius:12px;background:linear-gradient(135deg,#00b3a6,#045a63);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:26px;color:white;box-shadow:0 6px 18px rgba(0,0,0,0.5);}
.school-name{font-size:28px;font-weight:700;letter-spacing:0.6px;color:#ffefdc;text-shadow:0 3px 20px rgba(0,0,0,0.4);}
.meta{color:var(--muted);font-size:13px;}
.card{background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius: var(--radius);padding:18px;box-shadow: 0 10px 40px rgba(1,8,12,0.5);border:1px solid rgba(255,255,255,0.04);display:flex;flex-direction:column;gap:10px;min-height:120px;}
.card-header{display:flex;align-items:center;gap:12px;}
.card-header .icon{font-size:28px;color:var(--accent);text-shadow:0 0 14px rgba(255,138,61,0.15)}
.card-header h3{margin:0;font-size:18px;color:#ffdcbc}
.left-top{grid-column:1/2;grid-row:1/2;display:grid;grid-template-columns:1fr 1fr;gap:var(--gap)}
.left-bottom{grid-column:1/2;grid-row:2/3;display:grid;grid-template-columns:1fr 1fr;gap:var(--gap)}
.right-all{grid-column:2/3;grid-row:1/3;display:flex;flex-direction:column;gap:var(--gap)}
#obed{font-size:1rem;line-height:1.6;color:#eaf2f5;overflow:auto;padding-right:6px}
#obed h4{margin:0 0 8px 0;color:#ffd9b8}
#obed .meal{padding:8px 10px;border-radius:10px;margin-bottom:8px;background:linear-gradient(90deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.02)}
.clock-box{display:flex;flex-direction:column;align-items:flex-start;gap:8px}
#clock-time{font-size:48px;font-weight:700;color:#fff; letter-spacing:1px; text-shadow:0 6px 18px rgba(0,0,0,0.45)}
#clock-date{color:var(--muted);font-size:16px}
.weather-compact{display:flex;gap:12px;align-items:center}
.weather-compact .w-icon{font-size:34px}
.weather-compact .w-main{font-size:18px;font-weight:600}
.news{display:flex;gap:12px;align-items:flex-start}
.news .thumb{width:140px;height:100px;border-radius:10px;background:#072a2d;background-size:cover;background-position:center;flex-shrink:0}
.news .txt{flex:1;text-align:left;font-size:14px;color:#e6eef4}
.departures{display:flex;flex-direction:column;gap:6px;font-family:'Roboto Condensed',sans-serif;max-height:220px;overflow-y:auto;}
.dep-row{display:flex;justify-content:space-between;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01);font-size:14px}
.dep-time{font-weight:700;color:#ffd9b8}
.progress-bar{width:100%;height:10px;background:rgba(255,255,255,0.1);border-radius:5px;margin-top:6px;overflow:hidden;}
.progress-bar-inner{height:100%;background:var(--accent);width:0%;transition:width 0.2s;}
.ticker{grid-column:1/-1;height:38px;border-radius:10px;background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));display:flex;align-items:center;overflow:hidden;padding:6px 12px;border:1px solid rgba(255,255,255,0.03);}
.ticker .marquee{white-space:nowrap;display:inline-block;transform:translate3d(0,0,0);animation:marq 22s linear infinite}
@keyframes marq{0%{transform:translateX(100%)}100%{transform:translateX(-100%)}}
.live-clock-badge{position:fixed;left:28px;bottom:28px;background:var(--accent);color:#081018;padding:10px 14px;border-radius:10px;font-weight:700;box-shadow:0 8px 30px rgba(0,0,0,0.6);z-index:40}
@media (max-width:1200px){
.board{grid-template-columns: 1fr;grid-template-rows:auto 1fr 1fr;align-items:start}
.left-top,.left-bottom{grid-column:1}
.right-all{grid-column:1}
.live-clock-badge{left:14px;bottom:14px;font-size:14px}
}
</style>
</head>
<body>
<div class="board" id="board">
<div class="topbar">
<div class="title">
<div class="logo">≈†</div>
<div>
<div class="school-name">Z≈† B≈ôezov√© Hory</div>
<div class="meta" id="meta-status">Aktualizov√°no: ‚Äî</div>
</div>
</div>
<div class="meta">Nap√°jen√≠: online ‚Ä¢ Re≈æim: ve≈ôejn√° tabule</div>
</div>

<div class="left-top">
<!-- ƒåas + hodina + progress + poƒças√≠ -->
<div class="card">
<div class="card-header">
<div class="icon"><i class="fa-regular fa-clock"></i></div>
<div><h3>ƒåas & Datum</h3><div class="meta">P≈ôesnost: syst√©mov√°</div></div>
</div>
<div class="clock-box">
<div id="clock-time">--:--:--</div>
<div id="clock-date">‚Äî</div>
<div id="current-hour">Hodina: ‚Äî</div>
<div class="progress-bar"><div id="hour-progress" class="progress-bar-inner"></div></div>
<div class="weather-compact"><div class="w-icon">‚õÖ</div><div class="w-main">Naƒç√≠t√°m poƒças√≠...</div></div>
<div id="holiday">Sv√°tek: ‚Äî</div>
</div>
</div>

<!-- Odjezdy PID -->
<div class="card">
<div class="card-header">
<div class="icon"><i class="fa-solid fa-bus"></i></div>
<div><h3>Odjezdy PID</h3><div class="meta">Autobusy</div></div>
</div>
<div class="departures" id="departures">Naƒç√≠t√°m odjezdy...</div>
</div>
</div>

<!-- Dal≈°√≠ karty ... obƒõd, pl√°n akc√≠, aktuality, poƒças√≠ ‚Üí nech√°v√°m p≈Øvodn√≠ -->
<div class="left-bottom">
<!-- Obƒõd, pl√°n akc√≠ -->
<div class="card" style="min-height:260px">
<div class="card-header">
<div class="icon"><i class="fa-solid fa-utensils"></i></div>
<div><h3>Dne≈°n√≠ obƒõd</h3><div class="meta">Zdroj: zsbrezovehory.cz</div></div>
</div>
<div id="obed"><em>Naƒç√≠t√°m j√≠deln√≠ƒçek...</em></div>
</div>

<div class="card">
<div class="card-header">
<div class="icon"><i class="fa-regular fa-calendar-days"></i></div>
<div><h3>Pl√°n akc√≠</h3><div class="meta">T√Ωdenn√≠ p≈ôehled</div></div>
</div>
<div id="events">Naƒç√≠t√°m akce...</div>
</div>
</div>

<div class="right-all">
<div class="card">
<div class="card-header">
<div class="icon"><i class="fa-solid fa-cloud-sun"></i></div>
<div><h3>Poƒças√≠</h3><div class="meta">Aktu√°ln√≠ + 2 dny</div></div>
</div>
<div class="weather-forecast" id="weather">Naƒç√≠t√°m...</div>
</div>
</div>

<div class="ticker"><div class="marquee" id="ticker-text">V√≠tejte na tabuli ≈°koly ‚Äî aktualizace ka≈æd√Ωch 30 sekund!</div></div>
</div>

<script>
function updateClock(){
  const now = new Date();
  const hours = now.getHours().toString().padStart(2,'0');
  const minutes = now.getMinutes().toString().padStart(2,'0');
  const seconds = now.getSeconds().toString().padStart(2,'0');
  document.getElementById('clock-time').textContent = `${hours}:${minutes}:${seconds}`;
  document.getElementById('clock-date').textContent = now.toLocaleDateString('cs-CZ',{weekday:'long',day:'numeric',month:'long',year:'numeric'});
  // Hodina 0‚Äì9
  const startHour = 7; // prvn√≠ hodina 7:00
  const endHour = 16; // posledn√≠ hodina 16:00
  const totalHours = 10; // 0‚Äì9
  let h = Math.floor((now.getHours()-startHour)*60+now.getMinutes())/((endHour-startHour)*60)*totalHours;
  h = Math.min(Math.max(Math.floor(h),0),9);
  document.getElementById('current-hour').textContent = `Hodina: ${h}`;
  // Progress bar hodiny
  const currentMinute = now.getMinutes();
  const prog = (currentMinute/60*100).toFixed(1);
  document.getElementById('hour-progress').style.width = prog+'%';
}

// Sv√°tky CZ
async function loadHoliday(){
  try{
    const now = new Date();
    const month = (now.getMonth()+1).toString().padStart(2,'0');
    const day = now.getDate().toString().padStart(2,'0');
    const res = await fetch(`https://svatky.adresa.info/json?datum=${day}.${month}`);
    const data = await res.json();
    const h = data.svatky.map(s=>s.jmeno).join(', ');
    document.getElementById('holiday').textContent = `Sv√°tek: ${h}`;
  }catch(e){
    document.getElementById('holiday').textContent = 'Sv√°tek: ‚Äî';
  }
}

// Poƒças√≠ ‚Äî OpenWeatherMap (m≈Ø≈æe≈° d√°t sv≈Øj API kl√≠ƒç)
const OWM_KEY = 'TV≈ÆJ_API_KEY';
async function loadWeather(){
  try{
    const cityId = '3067696'; // P≈ô√≠bram
    const res = await fetch(`https://api.openweathermap.org/data/2.5/forecast?id=${cityId}&units=metric&lang=cs&cnt=16&appid=${OWM_KEY}`);
    const data = await res.json();
    // Aktu√°ln√≠
    const now = new Date();
    let current = data.list.find(l=>new Date(l.dt*1000).getHours()===now.getHours()) || data.list[0];
    document.querySelector('.weather-compact .w-icon').textContent = 'üå§Ô∏è';
    document.querySelector('.weather-compact .w-main').textContent = `${Math.round(current.main.temp)}¬∞C, ${current.weather[0].description}`;
    // Z√≠tra a poz√≠t≈ô√≠
    const forecastEl = document.getElementById('weather');
    forecastEl.innerHTML='';
    const days = [];
    data.list.forEach(item=>{
      const d = new Date(item.dt*1000);
      const dateStr = d.toLocaleDateString('cs-CZ',{weekday:'short',day:'numeric',month:'numeric'});
      if(!days.find(x=>x.date===dateStr)){
        days.push({date:dateStr,temp:Math.round(item.main.temp),desc:item.weather[0].description,icon:'üå§Ô∏è'});
      }
    });
    days.slice(0,3).forEach(d=>{
      const div = document.createElement('div');
      div.textContent = `${d.date}: ${d.temp}¬∞C, ${d.desc}`;
      forecastEl.appendChild(div);
    });
  }catch(e){
    document.getElementById('weather').textContent='Poƒças√≠ nenahr√°no';
  }
}

// Odjezdy PID ‚Äî p≈ôes lok√°ln√≠ proxy nebo p≈ô√≠mo (pokud funguje CORS)
async function loadDepartures(){
  try{
    const stopId='52838'; // P≈ô√≠bram, B≈ôezov√© Hory, Mari√°nsk√°
    const res = await fetch(`http://localhost:3000/departures?stopAreaId=${stopId}&maxNo=5`);
    const data = await res.json();
    const depEl = document.getElementById('departures');
    depEl.innerHTML='';
    if(data.departures){
      data.departures.forEach(d=>{
        const div=document.createElement('div');
        div.className='dep-row';
        div.innerHTML=`<span>${d.line}</span><span class="dep-time">${d.time}</span>`;
        depEl.appendChild(div);
      });
    }else depEl.textContent='≈Ω√°dn√© odjezdy';
  }catch(e){
    document.getElementById('departures').textContent='Chyba p≈ôi naƒç√≠t√°n√≠ odjezd≈Ø';
  }
}

function updateAll(){
  updateClock();
  loadHoliday();
  loadWeather();
  loadDepartures();
}

updateAll();
setInterval(updateClock,1000);
setInterval(updateAll,30000);
</script>
</body>
</html>
